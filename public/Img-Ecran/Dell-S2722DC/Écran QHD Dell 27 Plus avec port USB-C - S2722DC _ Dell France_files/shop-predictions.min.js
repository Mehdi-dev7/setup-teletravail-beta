"use strict";Dell.ShopUserContext=Dell.ShopUserContext||{},Dell.ShopUserContext.Domain=Dell.ShopUserContext.Domain||{},function(e,t){(function(){this.shopUserContextDomain={GetCookies:function(e){var o=t.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));if(o)return decodeURI(o[2])},SetCookie:function(e,o,n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var r="expires="+i.toUTCString();t.cookie=e+"="+o+";"+r+";path=/; domain=.dell.com;"},GetMCMID:function(){var e=this.GetCookies("AMCV_4DD80861515CAB990A490D45%40AdobeOrg");if(e){var t=e.split("|");return t[t.indexOf("MCMID")+1]}},UpdateVistiorInfo:function(e){var t=JSON.parse(e);this.UpdateVisitorReturnCookie(e),this.UpdateVistiorPrediction(e),t.isPremierCookieEnabled&&this.UpdateIsPremierCookie(e),t.isTechFluencyCookieEnabled&&this.UpdateTechCategoryCookie(e)},UpdateVisitorReturnCookie:function(e){var t=JSON.parse(e);this.SetCookie("user_isreturn",t.returnCustomer,90)},UpdateTechCategoryCookie:function(e){var t=JSON.parse(e);t.techFluencyPredictions&&t.techFluencyPredictions.length>0&&this.SetCookie("user_techcategory",t.techFluencyPredictions[0].techCategory,90)},UpdateIsPremierCookie:function(e){var t=JSON.parse(e);null!=t.isPremier&&this.SetCookie("user_ispremier",t.isPremier,90)},UpdateVistiorPrediction:function(t){e.sessionStorage.user_predictions=t},DispatchEvent:function(o){t.dispatchEvent(new e.CustomEvent("ShopUserContext.Predictions",{detail:{predictionData:o}}))},SetPrediction:function(){var e=Dell.ShopUserContext.shopUserContextV1.GetDomainName();if(null!=e){"/"==e.slice(-1)&&(e=e.slice(0,-1));var t=e+"/csbapi/shopusercontext/prediction/requestmodel";this.InvokeApi(t)}else console.error("ShopUserContext api endpoint is undefined")},InvokeApi:function(e){if(!Dell.Metrics||!Dell.Metrics.sc)return void console.error("Dell.Metrics is null or undefined.");var t=Dell.Metrics.sc.pagename,o=Dell.Metrics.sc.module,n=this.GetMCMID();if(!(n&&t&&o))return void console.error("mcmId or pageName or moduleName can not be empty.");const i={McmId:n,PageName:t,ModuleName:o};e+=this.BuildQueryStringParam(i);var r=new XMLHttpRequest;r.open("GET",e,!0),r.send(),r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status&&r.status<300){var e=r.responseText;Dell.ShopUserContext.Domain.shopUserContextDomain.HandleSuccess(e)}else Dell.ShopUserContext.Domain.shopUserContextDomain.HandleError(r)},r.error=function(){Dell.ShopUserContext.Domain.shopUserContextDomain.HandleError(r)}},BuildQueryStringParam:function(e){return"?"+Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")},HandleSuccess:function(e){null==e||0===e.length?(console.error("shoptoolcontext API request failed"),Dell.ShopUserContext.Domain.shopUserContextDomain.DispatchEvent(null)):(Dell.ShopUserContext.Domain.shopUserContextDomain.UpdateVistiorInfo(e),Dell.ShopUserContext.Domain.shopUserContextDomain.DispatchEvent(e))},HandleError:function(e){e&&500==e.status&&console.warn(e.status+": "+e.responseText+" : shoptoolcontext API request failed"),Dell.ShopUserContext.Domain.shopUserContextDomain.DispatchEvent(null)}},this.Init=function(){this.shopUserContextDomain.SetPrediction()}}).call(Dell.ShopUserContext.Domain)}(window,document),"object"==typeof module&&module.exports&&(module.exports=Dell.ShopUserContext.Domain);